name: æ‰§è¡Œéƒ¨ç½²PMS-DOC
run-name: ${{ github.actor }} æµæ°´çº¿æ­£åœ¨éƒ¨ç½²PMS-DOCé¡¹ç›® ğŸš€
on:
  push:
    branches:
      - master # è¿™æ®µæ˜¯åœ¨æ¨é€åˆ° docs åˆ†æ”¯æ—¶è§¦å‘è¯¥å‘½ä»¤

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        with:
          ref: master # è¿™ä¸€æ­¥æ£€æŸ¥ docs ä»£ç 
      - name: Setup Node.js and pnpm
        uses: actions/setup-node@v3
        with:
          node-version: '20.10.0' # è®¾ç½® nodejs çš„ç‰ˆæœ¬
      - run: echo "ğŸ‰ è®¾ç½® nodejs çš„ç‰ˆæœ¬å®Œæˆ"
      - name: Install pnpm
        run: npm install -g pnpm # å…¨å±€å®‰è£… pnpm
      - run: echo "ğŸ‰ æ‰§è¡Œ npm install -g pnpm å…¨å±€å®‰è£…pnpm å®Œæˆ"
      - name: Install dependencies
        run: pnpm install # ä½¿ç”¨ pnpm å®‰è£…ä¾èµ–
      - run: echo "ğŸ‰ ä½¿ç”¨ pnpm install å®‰è£…ä¾èµ– å®Œæˆ"
      - name: Build VitePress
        run: pnpm run docs:build # è¿™é‡Œæ˜¯æ‰“åŒ… vitepress å‘½ä»¤
      - run: echo "ğŸ‰ æ‰§è¡Œ pnpm run docs:build å®Œæˆ"
      - name: Deploy to GitHub Pages
        uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.DOC_TOKEN }} # è¿™ä¸€æ­¥å¾ˆé‡è¦ï¼Œå•ç‹¬çœ‹ä¸‹é¢çš„å¤§æ­¥éª¤ï¼Œä¸»è¦æ˜¯ç”¨æ¥ç»™è¯¥è„šæœ¬ä¸€äº›ä»“åº“æƒé™
          publish_dir: .vitepress/dist # æŒ‡å®šè¯¥æ–‡ä»¶å¤¹ä¸­çš„ dist
          publish_branch: gh-pages # æ¨é€åˆ°å…³è”ä»“åº“çš„ gh-pages åˆ†æ”¯
          dotfiles: true  # åŒ…æ‹¬åœ¨æäº¤ä¸­ï¼Œå³ä½¿è¢« .gitignore æ–‡ä»¶å¿½ç•¥
      - name: åˆ—å‡ºå­˜å‚¨åº“ä¸­çš„æ–‡ä»¶
        run: |
          ls ${{ github.workspace }}
      - run: echo "ğŸ ä½œä¸šéƒ¨ç½²çš„çŠ¶æ€ä¸º ${{ job.status }}."
